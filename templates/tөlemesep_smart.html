<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>Aqsai3-10a “ö–∞—Ä–∂—ã –ë–∞—Å“õ–∞—Ä—É –ü–∞–Ω–µ–ª—ñ</title>
    <style>
        /* –ë–ê–°“ö–ê–†–£ –ü–ê–ù–ï–õ–Ü–ù–Ü“¢ –°–¢–ò–õ–Ü */
        body { font-family: Arial, sans-serif; background: #f0f2f5; color: #424242; font-size: 11px; padding: 10px; }
        .admin-panel { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); max-width: 1250px; margin: auto; }
        .section { border: 1px solid #ddd; padding: 15px; border-radius: 5px; margin-bottom: 20px; background: white; }
        .controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; background: #e9ecef; padding: 10px; border-radius: 5px; margin-bottom: 10px; } 
        .btn { padding: 6px 12px; cursor: pointer; color: white; border: none; border-radius: 4px; font-weight: bold; font-size: 11px; }
        .btn-green { background: #28a745; }
        .btn-blue { background: #007bff; }
        .btn-orange { background: #fd7e14; }
        .btn-red { background: #dc3545; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 11px; }
        th, td { border: 1px solid #ddd; padding: 6px; text-align: center; }
        th { background: #f8f9fa; }
        .stats-header { background: #e3f2fd; padding: 15px; border-radius: 5px; margin-bottom: 15px; font-size: 14px; border: 1px solid #b3d7ff; font-weight: bold; }
        .footer-total { background: #eee; font-weight: bold; }
    </style>
</head>
<body onload="init()">

<div class="admin-panel">
    <h2>üè† “ö–∞—Ä–∂—ã –ë–∞—Å“õ–∞—Ä—É –ü–∞–Ω–µ–ª—ñ</h2>

    <div id="statsHeader" class="stats-header">
        üìä –ñ–∞–ª–ø—ã –º”ô–ª—ñ–º–µ—Ç—Ç–µ—Ä: 
        <span style="margin-left: 20px;">–ü”ô—Ç–µ—Ä —Å–∞–Ω—ã: <span id="totalAptsCount">0</span></span>
        <span style="margin-left: 20px;">–ñ–∞–ª–ø—ã –∞—É–¥–∞–Ω—ã: <span id="totalAreaSum">0</span> –º¬≤</span>
    </div>

    <div class="controls">
        <label>–ü”ô—Ç–µ—Ä ‚Ññ:</label>
        <input type="text" id="aptInput" value="1" style="width: 60px;">
        <button class="btn btn-blue" onclick="loadApartment()">üîç –ö”©—Ä—Å–µ—Ç—É</button>
        <button class="btn btn-green" onclick="saveData()">üíæ –°–∞“õ—Ç–∞—É</button>
    </div>

    <div class="section">
        <h3>üìÖ –ê–π —Å–∞–π—ã–Ω“ì—ã —Ç”©–ª–µ–º–¥–µ—Ä —Ç—ñ–∑—ñ–º—ñ (–ï—Å–µ–ø)</h3>
        <div class="controls">
            <label>–ê–π–¥—ã —Ç–∞“£–¥–∞“£—ã–∑:</label>
            <select id="listMonthSelect">
                <option value="“ö–∞“£—Ç–∞—Ä">“ö–∞“£—Ç–∞—Ä</option><option value="–ê“õ–ø–∞–Ω">–ê“õ–ø–∞–Ω</option>
                <option value="–ù–∞—É—Ä—ã–∑">–ù–∞—É—Ä—ã–∑</option><option value="–°”ô—É—ñ—Ä">–°”ô—É—ñ—Ä</option>
                <option value="–ú–∞–º—ã—Ä">–ú–∞–º—ã—Ä</option><option value="–ú–∞—É—Å—ã–º">–ú–∞—É—Å—ã–º</option>
                <option value="–®—ñ–ª–¥–µ">–®—ñ–ª–¥–µ</option><option value="–¢–∞–º—ã–∑">–¢–∞–º—ã–∑</option>
                <option value="“ö—ã—Ä–∫“Ø–π–µ–∫">“ö—ã—Ä–∫“Ø–π–µ–∫</option><option value="“ö–∞–∑–∞–Ω">“ö–∞–∑–∞–Ω</option>
                <option value="“ö–∞—Ä–∞—à–∞">“ö–∞—Ä–∞—à–∞</option><option value="–ñ–µ–ª—Ç–æ“õ—Å–∞–Ω">–ñ–µ–ª—Ç–æ“õ—Å–∞–Ω</option>
            </select>
            <button onclick="generatePaymentList()" class="btn btn-blue">üîç –¢—ñ–∑—ñ–º–¥—ñ “õ“±—Ä—É</button>
        </div>
        
        <div id="paymentListContainer">
            <table id="mainPaymentTable">
                <thead>
                    <tr>
                        <th>–ü”ô—Ç–µ—Ä ‚Ññ</th>
                        <th>–ê—É–¥–∞–Ω—ã (–º¬≤)</th>
                        <th>–¢”©–ª–µ–º —Å–æ–º–∞—Å—ã (—Ç–≥)</th>
                        <th>–ë–ê–†–õ–´“í–´ (–ñ/–¢) <br><small>(–ë–∞–Ω–∫ –ø–µ–Ω –ö“Ø–Ω—ñ)</small></th>
                    </tr>
                </thead>
                <tbody id="paymentListBody">
                    </tbody>
                <tfoot id="paymentListFooter">
                    </tfoot>
            </table>
        </div>
    </div>
</div>

<script>
    // –¢“Ø–ø–Ω“±—Å“õ–∞ —Ñ–∞–π–ª–¥–∞“ì—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä –º–µ–Ω —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä
    let apartments = []; // –ë“±–ª –∂–µ—Ä–≥–µ —Å—ñ–∑–¥—ñ“£ APARTMENT_DATA —Ç—ñ–∑—ñ–º—ñ“£—ñ–∑ –∫–µ–ª–µ–¥—ñ
    let financeAccounts = {}; 

    function init() {
        // –ë–∞—Å—Ç–∞–ø“õ—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂“Ø–∫—Ç–µ—É –ª–æ–≥–∏–∫–∞—Å—ã
        generatePaymentList();
    }

    function generatePaymentList() {
        const tbody = document.getElementById('paymentListBody');
        const tfoot = document.getElementById('paymentListFooter');
        tbody.innerHTML = '';
        tfoot.innerHTML = '';

        let totalSum = 0;
        let totalArea = 0;

        // –ü”ô—Ç–µ—Ä–ª–µ—Ä–¥—ñ –∞–π–Ω–∞–ª—ã–ø —à—ã“ì—É
        apartments.forEach(apt => {
            const acc = financeAccounts[apt.id] || {};
            const sum = parseFloat(acc.paidAmount) || 0;
            const area = parseFloat(apt.area) || 0;
            
            totalSum += sum;
            totalArea += area;

            const tr = document.createElement('tr');
            // –ë–∞–Ω–∫ –ø–µ–Ω —Ç”©–ª–µ–º –∫“Ø–Ω—ñ–Ω –±—ñ—Ä—ñ–∫—Ç—ñ—Ä—É (—Å—ñ–∑ —Å“±—Ä–∞“ì–∞–Ω –±–∞“ì–∞–Ω)
            const bankAndDate = acc.bank ? `${acc.bank} | ${acc.payDate || ''}` : '‚Äî';

            tr.innerHTML = `
                <td>${apt.id}</td>
                <td>${area}</td>
                <td>${sum.toLocaleString()}</td>
                <td style="background: #f9f9f9; font-weight: bold;">
                    ${sum.toLocaleString()} —Ç–≥ <br>
                    <small style="color: #555; font-weight: normal;">${bankAndDate}</small>
                </td>
            `;
            tbody.appendChild(tr);
        });

        // –ë–ê–° –ñ–ê“í–´–ù–î–ê“í–´ –∫”©—Ä—Å–µ—Ç–∫—ñ—à—Ç–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
        document.getElementById('totalAptsCount').innerText = apartments.length;
        document.getElementById('totalAreaSum').innerText = totalArea.toFixed(2);

        // –ê–Ø“í–´–ù–î–ê“í–´ –ñ–ê–õ–ü–´ –ï–°–ï–ü–¢–ï–£ (FOOTER)
        const footerRow = document.createElement('tr');
        footerRow.className = 'footer-total';
        footerRow.innerHTML = `
            <td>–ë–ê–†–õ–´“í–´ (–ò–¢–û–ì–û):</td>
            <td>${totalArea.toFixed(2)} –º¬≤</td>
            <td>-</td>
            <td style="color: #007bff; font-size: 14px;">${totalSum.toLocaleString()} —Ç–≥</td>
        `;
        tfoot.appendChild(footerRow);
    }
</script>
</body>
</html>
